<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firewall Defense</title>
  <link rel="stylesheet" href="style.css">
  <!-- Load p5.js and p5.play from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/p5@1.11.4/lib/p5.js"></script>
  <script src="https://p5play.org/v3/planck.min.js"></script>
  <script src="https://p5play.org/v3/p5play.min.js"></script>
</head>
<body>
  <div class="header-ui">
    <h1>Firewall Defense</h1>
    <div id="global-health-container">
      Global Firewall Integrity: <span id="global-health-value">Loading...</span>
    </div>
    <div id="motd-container" style="display: none;">
      <span id="motd-label">Latest Government Transmission:</span> <span id="motd-value"></span>
    </div>
  </div>

  <div class="main-container">
    <div id="game-ui-left">
      <h2>Most Patriotic Corporations:</h2>
      <ol id="leaderboard-list">
        <li>Loading...</li>
      </ol>
      <hr>
      <div id="player-score-section" style="margin-top: 15px;">
        <h3>Your Score</h3>
        <div id="player-total-score" style="font-size: 1.2em; font-weight: bold;">Loading...</div>
        <p style="font-size: 0.9em; color: #888;">Your cumulative total score for this period</p>
        <p id="leaderboard-reset-countdown" style="font-size: 0.85em; color: #666; margin-top: 8px;"></p>
      </div>
    </div>

    <div id="canvas-container">
      <!-- p5.js canvas will be inserted here by sketch.js -->
    </div>

    <div id="game-ui-right">
      <h2>Game Status</h2>
      <div id="game-status">Waiting to start...</div>
      
      <div id="difficulty-selector">
        <label for="difficulty">Difficulty:</label>
        <select id="difficulty">
          <option value="easy">Easy</option>
          <option value="medium" selected>Medium</option>
          <option value="hard">Hard</option>
        </select>
      </div>
      
      <div id="local-score">Score: 0</div>
      <div id="game-timer">Time: 60</div>
      <div id="bugs-stats">
        <div id="bugs-killed">Bugs Squashed: 0</div>
        <div id="bugs-exploited">Bugs Let In: 0</div>
      </div>
      <button id="start-game-btn">Start Game</button>
      
      <hr>
      <h2>Profile</h2>
      <div id="profile-info">
        <div>ID: <span id="player-id">...</span></div>
        <div>Corporation Name: <input type="text" id="product-name-input" placeholder="Your Corporation Name" maxlength="128" /><span id="product-name-counter" style="font-size: 0.85em; color: #888; margin-left: 5px;">0/64</span></div>
        <div>Tagline: <input type="text" id="tagline-input" maxlength="256" /><span id="tagline-counter" style="font-size: 0.85em; color: #888; margin-left: 5px;">0/128</span></div>
        <div>Color: <input type="color" id="color-input" /></div>
        <button id="profile-save-btn">Save Profile</button>
      </div>
      <hr>
      <h2>Notifications</h2>
      <div id="notification-toast"></div>
    </div>
  </div>

  <!-- Profile Setup Modal -->
  <div id="profile-setup-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 1000; justify-content: center; align-items: center;">
    <div style="background: #0a0a0a; border: 2px solid #00ff00; padding: 30px; max-width: 500px; width: 90%; font-family: 'Courier New', monospace;">
      <h2 style="color: #00ff00; margin-top: 0;">Welcome to Firewall Defense</h2>
      <p style="color: #00ff00; line-height: 1.6;">
        Vulnerabilities in Cyber Earth's firewall are being exploited by alien bugs. Corporations are sending their best IT specialists to fight them. Bounce bugs off screen to stop them passing through and score points. Corporations with the most points are rewarded valuable advertising space by the global government.
      </p>
      <p style="color: #00ff00; line-height: 1.6; margin-top: 15px;">
        To get started, please set up your corporation profile. Your Corporation Name and Tagline will be displayed on the leaderboard!
      </p>
      <div style="margin: 20px 0;">
        <label style="color: #00ff00; display: block; margin-bottom: 5px;">Corporation Name:</label>
        <input type="text" id="modal-product-name-input" placeholder="Your Corporation Name" style="width: 100%; padding: 8px; background: #000; color: #00ff00; border: 1px solid #00ff00; font-family: 'Courier New', monospace;" />
        <span id="modal-product-name-counter" style="font-size: 0.85em; color: #888; margin-left: 5px;">0/64</span>
      </div>
      <div style="margin: 20px 0;">
        <label style="color: #00ff00; display: block; margin-bottom: 5px;">Tagline:</label>
        <input type="text" id="modal-tagline-input" placeholder="Your Tagline" style="width: 100%; padding: 8px; background: #000; color: #00ff00; border: 1px solid #00ff00; font-family: 'Courier New', monospace;" />
        <span id="modal-tagline-counter" style="font-size: 0.85em; color: #888; margin-left: 5px;">0/128</span>
      </div>
      <button id="modal-save-profile-btn" style="width: 100%; padding: 12px; background: #00ff00; color: #000; border: none; font-family: 'Courier New', monospace; font-weight: bold; cursor: pointer; margin-top: 10px;">
        Save Profile & Continue
      </button>
    </div>
  </div>

  <!-- Load our game logic -->
  <!-- API URLs injected by deployment script -->
  <script>
    // These will be injected by inject-config.sh during container startup
    // For local development, defaults to localhost (see api.js)
  </script>
  <script src="api.js"></script>
  <script src="sketch.js"></script>
</body>
</html>

